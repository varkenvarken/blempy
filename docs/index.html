<!DOCTYPE html>
<html>
 <head>
  <title>
   README.md
  </title>
  <meta content="text/html;charset=utf-8" http-equiv="Content-type"/>
  <title>
   blenderaddons-ng
  </title>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <!-- Amaranth font from Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Amaranth:700&amp;display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f7fafc;
            margin: 0;
            padding: 0;
            color: #1a1a1a;
            width: 900px;
            margin:auto;
        }

        header {
            background: #fff;
            color: #2a4d69;
            padding: 2rem 1rem 1rem 1rem;
            text-align: center;
        }

        header a {
            color: #2a4d69;
            text-decoration: none;
            font-weight: bold;
        }

        header a:visited {
            color: #2a4d69;
            text-decoration: none;
        }

        #logo {
            max-width: 300px;
            margin-bottom: 1rem;
            float: left;
            margin-top: -20px;
        }

        h1,
        h2 {
            font-family: 'Amaranth', Arial, sans-serif;
        }

        h1 {
            margin-top: 0;
            font-size: 2.4rem;
        }

        h2 {
            color: #2a4d69;
        }

        .container {
            max-width: 900px;
            margin: 2rem auto 0 auto;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
            padding: 2rem;
        }

        ul {
            margin: 1rem 0 1rem 2rem;
        }

        pre,
        code {
            background: #f3f3f3;
            border-radius: 4px;
            padding: 0.2em 0.4em;
            font-size: 1em;
        }

        pre {
            padding: 1em;
            overflow-x: auto;
        }

        footer {
            text-align: center;
            padding: 2rem 1rem 1rem 1rem;
            color: #888;
            font-size: 1rem;
        }

        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }
        }

        .github-link {
            color: #4183c4;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s;
        }

        .github-link:hover {
            color: #23527c;
        }

        .badge-list {
            margin-bottom: 1.5rem;
        }

        .badge-list img {
            vertical-align: middle;
            height: 24px;
            margin-right: 6px;
        }
  </style>
  <style>
   /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
  </style>
  <script src="https://unpkg.com/mermaid/dist/mermaid.min.js">
  </script>
 </head>
 <body>
  <script>
   mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
  <p>
   <img alt="PyPI - Version" src="https://img.shields.io/pypi/v/blempy"/>
  </p>
  <h1 id="blempy--blender-%E2%86%94-numpy-helpers">
   blempy — Blender ↔ NumPy helpers
  </h1>
  <p>
   <code>
    blempy
   </code>
   provides small, safe utilities to efficiently transfer Blender property-collection attributes (e.g. vertex coordinates) to/from NumPy arrays and perform vectorized operations with minimal Python overhead.
  </p>
  <blockquote>
   <p>
    [!NOTE]
    <br/>
    This module is not fully fleshed out yet, and its contents/interface may change
   </p>
  </blockquote>
  <h2 id="key-classes">
   Key classes
  </h2>
  <ul>
   <li>
    <p>
     <code>
      PropertyCollectionAttributeProxy
     </code>
    </p>
    <ul>
     <li>
      Purpose: bulk transfer for any property-collection attribute (uses foreach_get/foreach_set).
     </li>
     <li>
      Important members:
      <ul>
       <li>
        get(): fills/allocates a float32 NumPy array from the property collection.
       </li>
       <li>
        set(): writes the NumPy array back to the property collection.
       </li>
       <li>
        ndarray, items, length: current array and shape metadata.
       </li>
      </ul>
     </li>
     <li>
      Behavior: automatically reallocates array when collection size or vector length changes. Raises ValueError on empty collections.
     </li>
    </ul>
   </li>
   <li>
    <p>
     <code>
      VectorCollectionProxy(PropertyCollectionAttributeProxy)
     </code>
    </p>
    <ul>
     <li>
      Purpose: convenient access to 3D/4D vector collections.
     </li>
     <li>
      Methods:
      <ul>
       <li>
        extend(normal=False): append a 4th column (ones by default, zeros if normal=True).
       </li>
       <li>
        discard(): remove the 4th column.
       </li>
       <li>
        __matmul__(matrix): apply a matrix to all vectors (in-place) and return self.
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li>
    <p>
     <code>
      LoopVectorAttributeProxy
     </code>
    </p>
    <ul>
     <li>
      Purpose: convenient access to loop layer attributes, i.e. attributes associated with face corners, like uv-coordinates.
     </li>
     <li>
      Methods:
      <ul>
       <li>
        __matmul____(matrix): apply a matrix to all vectors (in-place) and return self.
       </li>
       <li>
        __iter____ and __next____: to return all the loop layer attributes for each polygon in a mesh
       </li>
       <li>
        __len____: returns the number of polygons in a mesh
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li>
    <p>
     <code>
      AttributeProxy
     </code>
    </p>
    <ul>
     <li>
      Purpose: access to any layer in the unified attribute layers of a Mesh.
     </li>
     <li>
      Methods:
      <ul>
       <li>
        __iter____ and __next____: to return all the loop layer attributes for each polygon in a mesh
       </li>
       <li>
        __len____: returns the number of polygons in a mesh
       </li>
       <li>
        __getitem()__: return a single item (i.e. a vector, a scalar value, or (for lop layer properties) an array of vectors)
       </li>
       <li>
        __setitem()__: set the value of an item
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
  <h2 id="characteristics--notes">
   Characteristics / notes
  </h2>
  <ul>
   <li>
    Designed around Blender's volatile property-collection references — proxies compute references on each get/set.
   </li>
   <li>
    Intended for workflows where mesh data is read/written in bulk (faster than per-item Python attribute access).
   </li>
   <li>
    Raises clear exceptions for empty collections or incompatible shapes.
   </li>
  </ul>
  <h2 id="minimal-usage-examples">
   Minimal usage examples
  </h2>
  <p>
   Transforming all vertex coordinates:
  </p>
  <pre class="hljs"><code><div><span class="hljs-keyword">from</span> mathutils <span class="hljs-keyword">import</span> Matrix
<span class="hljs-keyword">from</span> bpy.context <span class="hljs-keyword">import</span> active_object
<span class="hljs-keyword">from</span> blempy <span class="hljs-keyword">import</span> VectorCollectionProxy

mesh = active_object.data
vproxy = VectorCollectionProxy(mesh, <span class="hljs-string">"vertices"</span>, <span class="hljs-string">"co"</span>)
vproxy.get()                        <span class="hljs-comment"># load vertex coordinates into vproxy.ndarray</span>
vproxy.extend()                     <span class="hljs-comment"># convert to 4D so that matrix multiplication</span>
                                    <span class="hljs-comment"># can deal with translation too</span>
<span class="hljs-comment"># combine a rotation and a translation into a single matrix</span>
matrix = Matrix.Rotation(pi/<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])
matrix = matrix @ Matrix.Translation(<span class="hljs-number">4</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])    
vproxy = vproxy @ matrix            <span class="hljs-comment"># transform in-place</span>
vproxy.discard()                    <span class="hljs-comment"># discard the 4th column</span>
vproxy.set()                        <span class="hljs-comment"># write back to mesh</span>
</div></code></pre>
  <p>
   Give all faces of a mesh a uniform but unique random greyscale color:
  </p>
  <pre class="hljs"><code><div><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> bpy.context <span class="hljs-keyword">import</span> active_object
<span class="hljs-keyword">from</span> blempy <span class="hljs-keyword">import</span> AttributeProxy

mesh = active_object.data
<span class="hljs-comment"># assume the mesh already has a vertex color layer called "Color"</span>
proxy = blempy.AttributeProxy(mesh, <span class="hljs-string">"Color"</span>)

<span class="hljs-comment"># iterate over faces and set all loops in each individual face to a distinct grey level</span>
<span class="hljs-comment"># setting all loops to the same value will cause the face to have a uniform color</span>
<span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> no need for a proxy.get() call, we will replace all data so we don´t need the originals</span>
<span class="hljs-keyword">for</span> index, polygon_loops <span class="hljs-keyword">in</span> enumerate(proxy):
    grey_level = random()
    polygon_loops[:] = [grey_level, grey_level, grey_level, <span class="hljs-number">1.0</span>]

<span class="hljs-comment"># sync data back to the mesh</span>
proxy.set()
</div></code></pre>
  <h2 id="installation">
   Installation
  </h2>
  <p>
   <code>
    blempy
   </code>
   is available as a package on
   <a href="https://pypi.org/project/blempy/">
    pypi
   </a>
   and can be installed in the usual way:
  </p>
  <pre class="hljs"><code><div>python -m pip install blempy
</div></code></pre>
  <p>
   But that would install the package in the default location. That is fine if you use Blender as a module, but if your are developing for the "complete" Blender, you would need to install it inside your Blender environment. A refresher on how to do that can be found in
   <a href="https://blog.michelanders.nl/2021/06/installing-python-packages-with-pip-in-your-blender-environment.html">
    this old article
   </a>
   .
  </p>
  <p>
   If you are developing an addon that uses the
   <code>
    blempy
   </code>
   package, it is probably easiest to bundle it with your add-on, i.e. simply copy the
   <a href="/blempy/">
    blempy folder
   </a>
   from the repository into your own project. By copying, you automatically fix the version, so that if blempy gets a breaking update you won´t have to deal with that immediately.
  </p>
  <h2 id="todo">
   TODO
  </h2>
  <ul>
   <li>
    <p>
     <input id="checkbox0" type="checkbox"/>
     <label for="checkbox0">
      additional convenience functions for frequently used vector operations like translate, scale, rotate, space conversions, ...
     </label>
    </p>
   </li>
   <li>
    <p>
     <input id="checkbox1" type="checkbox"/>
     <label for="checkbox1">
      ... possibly even mapped to dunder methods (like
     </label>
     <code>
      __add__
     </code>
     for translation or
     <code>
      __mul__
     </code>
     for scale, etc.)
    </p>
   </li>
   <li>
    <p>
     <input checked="true" id="checkbox2" type="checkbox"/>
     <label for="checkbox2">
      a specific subclass to deal with properties that are associated with the loop layer
     </label>
    </p>
    <p>
     like vertex colors and uv coordinates
    </p>
   </li>
   <li>
    <p>
     <input checked="true" id="checkbox3" type="checkbox"/>
     <label for="checkbox3">
      extend AttributeProxy to instantiate a proxy by refering to layers directly or by index
     </label>
    </p>
    <p>
     for example to refer mesh.attributes.active directly
    </p>
   </li>
   <li>
    <p>
     <input id="checkbox4" type="checkbox"/>
     <label for="checkbox4">
      extend AttributeProxy to work with non-loop attributes
     </label>
    </p>
    <p>
     vertex, edge, face, ...
    </p>
   </li>
   <li>
    <p>
     <input id="checkbox5" type="checkbox"/>
     <label for="checkbox5">
      extend AttributeProxy to work with BMesh objects
     </label>
    </p>
   </li>
   <li>
    <p>
     <input id="checkbox6" type="checkbox"/>
     <label for="checkbox6">
      extend AttributeProxy to work with non mesh objects
     </label>
    </p>
    <p>
     curve etc.
    </p>
   </li>
  </ul>
 </body>
</html>
